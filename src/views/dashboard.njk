{% extends "govuk/template.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/header/macro.njk" import govukHeader %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/phase-banner/macro.njk" import govukPhaseBanner %}
{% from "govuk/components/notification-banner/macro.njk" import govukNotificationBanner %}

{% block pageTitle %}Library Management System{% endblock %}

{% block head %}
    <link rel="stylesheet" href="/govuk/govuk-frontend.min.css">
{% endblock %}

{% block header %}
    {{ govukHeader({
        serviceName: "Library Management System",
        serviceUrl: "/dashboard"
    }) }}
{% endblock %}

{% block content %}
    {# NOTE: Replace these with actual data from backend #}
    {% set totalBooks = 245 %}
    {% set availableCopies = 412 %}
    {% set activeMembers = 87 %}
    {% set overdueItems = 5 %}
    {% set lowInventoryThreshold = 2 %}
    {% set recentActivityLimit = 5 %}

    <h1 class="govuk-heading-xl">Dashboard</h1>

    <!-- Overview Cards Section -->
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-quarter">
            <div class="govuk-panel govuk-panel--confirmation govuk-!-text-align-centre">
                <div class="govuk-panel__body govuk-!-font-size-48 govuk-!-font-weight-bold">{{ totalBooks }}</div>
                <div class="govuk-panel__title govuk-!-font-size-19">Total&nbsp;Books</div>
            </div>
        </div>
        <div class="govuk-grid-column-one-quarter">
            <div class="govuk-panel govuk-panel--confirmation govuk-!-text-align-centre">
                <div class="govuk-panel__body govuk-!-font-size-48 govuk-!-font-weight-bold">{{ availableCopies }}</div>
                <div class="govuk-panel__title govuk-!-font-size-19">Available&nbsp;Copies</div>
            </div>
        </div>
        <div class="govuk-grid-column-one-quarter">
            <div class="govuk-panel govuk-panel--confirmation govuk-!-text-align-centre">
                <div class="govuk-panel__body govuk-!-font-size-48 govuk-!-font-weight-bold">{{ activeMembers }}</div>
                <div class="govuk-panel__title govuk-!-font-size-19">Active&nbsp;Members</div>
            </div>
        </div>
        <div class="govuk-grid-column-one-quarter">
            <div class="govuk-panel govuk-panel--confirmation govuk-!-text-align-centre">
                <div class="govuk-panel__body govuk-!-font-size-48 govuk-!-font-weight-bold">{{ overdueItems }}</div>
                <div class="govuk-panel__title govuk-!-font-size-19">Overdue&nbsp;Items</div>
            </div>
        </div>
    </div>

    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

  <!-- Quick Actions Section -->
    <h2 class="govuk-heading-l">Quick Actions</h2>
    <div class="govuk-button-group">
        {{ govukButton({
            text: "Search Books",
            href: "/books/search",
            classes: "govuk-!-margin-bottom-3"
        }) }}
        {{ govukButton({
            text: "Check Out Book",
            href: "/borrowing/checkout",
            classes: "govuk-!-margin-bottom-3"
        }) }}
        {{ govukButton({
            text: "Return Book",
            href: "/borrowing/checkin",
            classes: "govuk-!-margin-bottom-3"
        }) }}
        {{ govukButton({
            text: "Search Members",
            href: "/members/search",
            classes: "govuk-!-margin-bottom-3"
        }) }}
        {{ govukButton({
            text: "View Reports",
            href: "/reports",
            classes: "govuk-!-margin-bottom-3"
        }) }}
    </div>

    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

    <!-- Alerts Section -->
    <h2 class="govuk-heading-l">Alerts</h2>
    {% set overdueHtml %}
        <p class="govuk-body">You have <strong>{{ overdueItems }} overdue items</strong>. Please contact members with outstanding returns.</p>
    {% endset %}
    {{ govukNotificationBanner({
        type: "alert",
        titleText: "Warning",
        html: overdueHtml
    }) }}

    {# NOTE: Replace example low inventory books with actual data #}
    {% set lowInventoryHtml %}
        <p class="govuk-body">Low inventory (threshold: {{ lowInventoryThreshold }}).</p>
        <ul class="govuk-list govuk-list--bullet">
            <li><strong>The Great Gatsby</strong> - 1 copy available</li>
            <li><strong>To Kill a Mockingbird</strong> - 2 copies available (at threshold)</li>
        </ul>
    {% endset %}
    {{ govukNotificationBanner({
        type: "alert",
        titleText: "Warning",
        html: lowInventoryHtml
    }) }}

    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

    <!-- Recent Activity Section -->
    <h2 class="govuk-heading-l">Recent Activity</h2>
    {# NOTE: Replace with actual transaction data, limit to recentActivityLimit = {{ recentActivityLimit }} #}
    <table class="govuk-table">
        <thead class="govuk-table__head">
            <tr class="govuk-table__row">
                <th scope="col" class="govuk-table__header">Date & Time</th>
                <th scope="col" class="govuk-table__header">Transaction Type</th>
                <th scope="col" class="govuk-table__header">Member</th>
                <th scope="col" class="govuk-table__header">Book</th>
            </tr>
        </thead>
        <tbody class="govuk-table__body">
            <tr class="govuk-table__row">
                <td class="govuk-table__cell">5 Feb 2026, 14:30</td>
                <td class="govuk-table__cell">Check-out</td>
                <td class="govuk-table__cell">John Smith</td>
                <td class="govuk-table__cell">1984</td>
            </tr>
            <tr class="govuk-table__row">
                <td class="govuk-table__cell">5 Feb 2026, 11:15</td>
                <td class="govuk-table__cell">Return</td>
                <td class="govuk-table__cell">Sarah Johnson</td>
                <td class="govuk-table__cell">The Hobbit</td>
            </tr>
            <tr class="govuk-table__row">
                <td class="govuk-table__cell">4 Feb 2026, 09:45</td>
                <td class="govuk-table__cell">Check-out</td>
                <td class="govuk-table__cell">Emily Davis</td>
                <td class="govuk-table__cell">Pride and Prejudice</td>
            </tr>
            <tr class="govuk-table__row">
                <td class="govuk-table__cell">4 Feb 2026, 16:20</td>
                <td class="govuk-table__cell">Check-out</td>
                <td class="govuk-table__cell">Michael Brown</td>
                <td class="govuk-table__cell">The Catcher in the Rye</td>
            </tr>
            <tr class="govuk-table__row">
                <td class="govuk-table__cell">3 Feb 2026, 10:05</td>
                <td class="govuk-table__cell">Return</td>
                <td class="govuk-table__cell">Lisa Wilson</td>
                <td class="govuk-table__cell">Jane Eyre</td>
            </tr>
        </tbody>
    </table>
{% endblock %}

{% block bodyEnd %}
    <script src="/govuk/govuk-frontend.min.js"></script>
    <script>
        window.GOVUKFrontend.initAll();
    </script>
{% endblock %}